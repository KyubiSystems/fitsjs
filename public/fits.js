((function(){if(!this.require){var a={},b={},c=function(f,g){var h=d(g,f),i=d(h,"./index"),j,k;j=b[h]||b[i];if(j)return j;if(k=a[h]||a[h=i])return j={id:h,exports:{}},b[h]=j.exports,k(j.exports,function(a){return c(a,e(h))},j),b[h]=j.exports;throw"module "+f+" not found"},d=function(a,b){var c=[],d,e;/^\.\.?(\/|$)/.test(b)?d=[a,b].join("/").split("/"):d=b.split("/");for(var f=0,g=d.length;f<g;f++)e=d[f],e==".."?c.pop():e!="."&&e!=""&&c.push(e);return c.join("/")},e=function(a){return a.split("/").slice(0,-1).join("/")};this.require=function(a){return c(a,"")},this.require.define=function(b){for(var c in b)a[c]=b[c]},this.require.modules=a,this.require.cache=b}return this.require.define})).call(this)({"jDataView/src/jdataview":function(a,b,c){(function(a){var b={ArrayBuffer:typeof ArrayBuffer!="undefined",DataView:typeof DataView!="undefined"&&"getFloat64"in DataView.prototype,NodeBuffer:typeof Buffer!="undefined",NodeBufferFull:typeof Buffer!="undefined"&&"readInt8LE"in Buffer,NodeBufferEndian:typeof Buffer!="undefined"&&"readInt8"in Buffer},d=function(a,c,d,e){if(!(this instanceof arguments.callee))throw new Error("jDataView constructor may not be called as a function");this.buffer=a;if(!(b.NodeBuffer&&a instanceof Buffer)&&!(b.ArrayBuffer&&a instanceof ArrayBuffer)&&typeof a!="string")throw new TypeError("jDataView buffer has an incompatible type");this._isArrayBuffer=b.ArrayBuffer&&a instanceof ArrayBuffer,this._isDataView=b.DataView&&this._isArrayBuffer,this._isNodeBuffer=b.NodeBuffer&&a instanceof Buffer,this._littleEndian=e===undefined?!0:e;var f=this._isArrayBuffer?a.byteLength:a.length;c===undefined&&(c=0),this.byteOffset=c,d===undefined&&(d=f-c),this.byteLength=d;if(!this._isDataView){if(typeof c!="number")throw new TypeError("jDataView byteOffset is not a number");if(typeof d!="number")throw new TypeError("jDataView byteLength is not a number");if(typeof c<0)throw new Error("jDataView byteOffset is negative");if(typeof d<0)throw new Error("jDataView byteLength is negative")}this._isDataView&&(this._view=new DataView(a,c,d),this._start=0),this._start=c;if(c+d>f)throw new Error("jDataView (byteOffset+byteLength) value is out of bounds");this._offset=0};d.createBuffer=function(){if(b.NodeBuffer){var a=new Buffer(arguments.length);for(var c=0;c<arguments.length;++c)a[c]=arguments[c];return a}if(b.ArrayBuffer){var a=new ArrayBuffer(arguments.length),d=new Int8Array(a);for(var c=0;c<arguments.length;++c)d[c]=arguments[c];return a}return String.fromCharCode.apply(null,arguments)},d.prototype={getString:function(a,b){var c;b===undefined&&(b=this._offset);if(typeof b!="number")throw new TypeError("jDataView byteOffset is not a number");if(a<0||b+a>this.byteLength)throw new Error("jDataView length or (byteOffset+length) value is out of bounds");if(this._isNodeBuffer)c=this.buffer.toString("ascii",this._start+b,this._start+b+a);else{c="";for(var d=0;d<a;++d){var e=this.getUint8(b+d);c+=String.fromCharCode(e>127?65533:e)}}return this._offset=b+a,c},getChar:function(a){return this.getString(1,a)},tell:function(){return this._offset},seek:function(a){if(typeof a!="number")throw new TypeError("jDataView byteOffset is not a number");if(a<0||a>this.byteLength)throw new Error("jDataView byteOffset value is out of bounds");return this._offset=a},_endianness:function(a,b,c,d){return a+(d?c-b-1:b)},_getFloat64:function(a,b){var c=this._getUint8(this._endianness(a,0,8,b)),d=this._getUint8(this._endianness(a,1,8,b)),e=this._getUint8(this._endianness(a,2,8,b)),f=this._getUint8(this._endianness(a,3,8,b)),g=this._getUint8(this._endianness(a,4,8,b)),h=this._getUint8(this._endianness(a,5,8,b)),i=this._getUint8(this._endianness(a,6,8,b)),j=this._getUint8(this._endianness(a,7,8,b)),k=1-2*(c>>7),l=((c<<1&255)<<3|d>>4)-(Math.pow(2,10)-1),m=(d&15)*Math.pow(2,48)+e*Math.pow(2,40)+f*Math.pow(2,32)+g*Math.pow(2,24)+h*Math.pow(2,16)+i*Math.pow(2,8)+j;return l===1024?m!==0?NaN:k*Infinity:l===-1023?k*m*Math.pow(2,-1074):k*(1+m*Math.pow(2,-52))*Math.pow(2,l)},_getFloat32:function(a,b){var c=this._getUint8(this._endianness(a,0,4,b)),d=this._getUint8(this._endianness(a,1,4,b)),e=this._getUint8(this._endianness(a,2,4,b)),f=this._getUint8(this._endianness(a,3,4,b)),g=1-2*(c>>7),h=(c<<1&255|d>>7)-127,i=(d&127)<<16|e<<8|f;return h===128?i!==0?NaN:g*Infinity:h===-127?g*i*Math.pow(2,-149):g*(1+i*Math.pow(2,-23))*Math.pow(2,h)},_getInt32:function(a,b){var c=this._getUint32(a,b);return c>Math.pow(2,31)-1?c-Math.pow(2,32):c},_getUint32:function(a,b){var c=this._getUint8(this._endianness(a,0,4,b)),d=this._getUint8(this._endianness(a,1,4,b)),e=this._getUint8(this._endianness(a,2,4,b)),f=this._getUint8(this._endianness(a,3,4,b));return c*Math.pow(2,24)+(d<<16)+(e<<8)+f},_getInt16:function(a,b){var c=this._getUint16(a,b);return c>Math.pow(2,15)-1?c-Math.pow(2,16):c},_getUint16:function(a,b){var c=this._getUint8(this._endianness(a,0,2,b)),d=this._getUint8(this._endianness(a,1,2,b));return(c<<8)+d},_getInt8:function(a){var b=this._getUint8(a);return b>Math.pow(2,7)-1?b-Math.pow(2,8):b},_getUint8:function(a){return this._isArrayBuffer?(new Uint8Array(this.buffer,a,1))[0]:this._isNodeBuffer?this.buffer[a]:this.buffer.charCodeAt(a)&255}};var e={Int8:1,Int16:2,Int32:4,Uint8:1,Uint16:2,Uint32:4,Float32:4,Float64:8},f={Int8:"Int8",Int16:"Int16",Int32:"Int32",Uint8:"UInt8",Uint16:"UInt16",Uint32:"UInt32",Float32:"Float",Float64:"Double"};for(var g in e){if(!e.hasOwnProperty(g))continue;(function(c){var g=e[c];d.prototype["get"+c]=function(d,e){var h;e===undefined&&(e=this._littleEndian),d===undefined&&(d=this._offset);if(this._isDataView)h=this._view["get"+c](d,e);else if(this._isArrayBuffer&&(this._start+d)%g===0&&(g===1||e))h=(new a[c+"Array"](this.buffer,this._start+d,1))[0];else if(this._isNodeBuffer&&b.NodeBufferFull)e?h=this.buffer["read"+f[c]+"LE"](this._start+d):h=this.buffer["read"+f[c]+"BE"](this._start+d);else if(this._isNodeBuffer&&b.NodeBufferEndian)h=this.buffer["read"+f[c]](this._start+d,e);else{if(typeof d!="number")throw new TypeError("jDataView byteOffset is not a number");if(d+g>this.byteLength)throw new Error("jDataView (byteOffset+size) value is out of bounds");h=this["_get"+c](this._start+d,e)}return this._offset=d+g,h}})(g)}if(typeof jQuery!="undefined"&&jQuery.fn.jquery>="1.6.2"){var h=function(a){var b;try{b=IEBinaryToArray_ByteStr(a)}catch(c){var d="Function IEBinaryToArray_ByteStr(Binary)\r\n\tIEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n\tDim lastIndex\r\n\tlastIndex = LenB(Binary)\r\n\tif lastIndex mod 2 Then\r\n\t\tIEBinaryToArray_ByteStr_Last = AscB( MidB( Binary, lastIndex, 1 ) )\r\n\tElse\r\n\t\tIEBinaryToArray_ByteStr_Last = -1\r\n\tEnd If\r\nEnd Function\r\n";window.execScript(d,"vbscript"),b=IEBinaryToArray_ByteStr(a)}var e=IEBinaryToArray_ByteStr_Last(a),f="",g=0,h=b.length%8,i;while(g<h)i=b.charCodeAt(g++),f+=String.fromCharCode(i&255,i>>8);h=b.length;while(g<h)f+=String.fromCharCode((i=b.charCodeAt(g++),i&255),i>>8,(i=b.charCodeAt(g++),i&255),i>>8,(i=b.charCodeAt(g++),i&255),i>>8,(i=b.charCodeAt(g++),i&255),i>>8,(i=b.charCodeAt(g++),i&255),i>>8,(i=b.charCodeAt(g++),i&255),i>>8,(i=b.charCodeAt(g++),i&255),i>>8,(i=b.charCodeAt(g++),i&255),i>>8);return e>-1&&(f+=String.fromCharCode(e)),f};jQuery.ajaxSetup({converters:{"* dataview":function(a){return new d(a)}},accepts:{dataview:"text/plain; charset=x-user-defined"},responseHandler:{dataview:function(a,b,c){"mozResponseArrayBuffer"in c?a.text=c.mozResponseArrayBuffer:"responseType"in c&&c.responseType==="arraybuffer"&&c.response?a.text=c.response:"responseBody"in c?a.text=h(c.responseBody):a.text=c.responseText}}}),jQuery.ajaxPrefilter("dataview",function(a,b,c){jQuery.support.ajaxResponseType&&(a.hasOwnProperty("xhrFields")||(a.xhrFields={}),a.xhrFields.responseType="arraybuffer"),a.mimeType="text/plain; charset=x-user-defined"})}a.jDataView=(a.module||{}).exports=d,typeof c!="undefined"&&(c.exports=d)})(this)},"fits.binarytable":function(a,b,c){((function(){var a,d,e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};d=b("./fits.tabular"),a=function(a){function b(a,c){var d,e,f,g,h,i,j,k,l=this;b.__super__.constructor.apply(this,arguments);for(e=1,j=this.cols;1<=j?e<=j:e>=j;1<=j?e++:e--)f="TFORM"+e,i=c[f],h=i.match(b.arrayDescriptorPattern),h!=null?function(){var a,c;return c=h[1],a=function(){var a,d,e,f;e=l.view.getInt32(),f=l.view.getInt32(),l.current=l.view.tell(),l.view.seek(l.begin+l.tableLength+f),a=[];for(d=1;1<=e?d<=e:d>=e;1<=e?d++:d--)a.push(b.dataAccessors[c](l.view));return l.view.seek(l.current),a},l.accessors.push(a)}():(h=i.match(b.dataTypePattern),k=h.slice(1),g=k[0],d=k[1],g=g?parseInt(g):0,g===0||g===1?function(a){var c;return c=function(){var c;return c=b.dataAccessors[a](l.view),c},l.accessors.push(c)}(d):function(a){var c;return c=function(){var c,d;c=[];for(d=1;1<=g?d<=g:d>=g;1<=g?d++:d--)c.push(b.dataAccessors[a](l.view));return c},l.accessors.push(c)}(d))}return f(b,a),b.dataTypePattern=/(\d*)([L|X|B|I|J|K|A|E|D|C|M])/,b.arrayDescriptorPattern=/[0,1]*P([L|X|B|I|J|K|A|E|D|C|M])\((\d*)\)/,b}(d),typeof c!="undefined"&&c!==null&&(c.exports=a)})).call(this)},fits:function(a,b,c){((function(){var a;b("jDataView/src/jdataview"),a=this.FITS={},a.version="0.0.1",a.HDU=b("./fits.hdu"),a.File=b("./fits.file"),a.Header=b("./fits.header"),a.Image=b("./fits.image"),a.BinTable=b("./fits.binarytable"),a.CompImage=b("./fits.compressedimage"),a.Table=b("./fits.table"),a.ImageSet=b("./fits.imageset"),a.Visualize=b("./fits.visualize"),a.ImageStats=b("./fits.imagestats"),typeof c!="undefined"&&c!==null&&(c.exports=a)})).call(this)},"fits.compressedimage":function(a,b,c){((function(){var a,d,e,f=Object.prototype.hasOwnProperty,g=function(a,b){function d(){this.constructor=a}for(var c in b)f.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};e=b("./fits.tabular"),d=b("./fits.decompress"),a=function(a){function b(a,c){var d,e,f,g,h;b.__super__.constructor.apply(this,arguments),this.length+=c.PCOUNT,this.zcmptype=c.ZCMPTYPE,this.zbitpix=c.ZBITPIX,this.znaxis=c.ZNAXIS,this.zblank=b.setValue(c,"ZBLANK",void 0),this.blank=b.setValue(c,"BLANK",void 0),this.min=c["DATAMIN"]!=null?c.DATAMIN:void 0,this.max=c["DATAMAX"]!=null?c.DATAMAX:void 0,this.ztile=[];for(d=1,h=this.znaxis;1<=h?d<=h:d>=h;1<=h?d++:d--)g=c.contains("ZTILE"+d)?c["ZTILE"+d]:d===1?c.ZNAXIS1:1,this.ztile.push(g);this.algorithmParameters={},d=1;for(;;){e="ZNAME"+d;if(!c.contains(e))break;f="ZVAL"+d,this.algorithmParameters[c[e]]=c[f],d+=1}this["setDefaultParameters_"+this.zcmptype](),this.zmaskcmp=b.setValue(c,"ZMASKCMP",void 0),this.zquantiz=b.setValue(c,"ZQUANTIZ","LINEAR_SCALING"),this.bzero=b.setValue(c,"BZERO",0),this.bscale=b.setValue(c,"BSCALE",1),this.defineColumnAccessors(c),this.defineGetRow()}return g(b,a),b.dataTypePattern=/(\d*)([L|X|B|I|J|K|A|E|D|C|M])/,b.arrayDescriptorPattern=/[0,1]*P([L|X|B|I|J|K|A|E|D|C|M])\((\d*)\)/,b.extend(d),b.typedArray={B:Uint8Array,I:Int16Array,J:Int32Array,E:Float32Array,D:Float64Array,1:Uint8Array,2:Uint8Array,4:Int16Array,8:Int32Array},b.prototype.defineColumnAccessors=function(a){var c,d,e,f,g,h,i,j,k,l,m=this;this.columnNames={},l=[];for(e=1,j=this.cols;1<=j?e<=j:e>=j;1<=j?e++:e--){i=a["TFORM"+e],g=i.match(b.arrayDescriptorPattern),h=a["TTYPE"+e].toUpperCase(),this.columnNames[h]=e-1,c=null;if(g!=null){d=g[1];switch(h){case"COMPRESSED_DATA":(function(a){return c=function(){var c,d;return c=m._accessor(a),c==null?null:(d=new b.typedArray[m.algorithmParameters.BYTEPIX](m.ztile[0]),b.Rice(c,f,m.algorithmParameters.BLOCKSIZE,m.algorithmParameters.BYTEPIX,d,m.ztile[0]),d)}})(d);break;case"UNCOMPRESSED_DATA":(function(a){return c=m._accessor(a)})(d);break;case"GZIP_COMPRESSED_DATA":(function(a){return c=m._accessor(a)})(d);break;default:(function(a){return c=m._accessor(a)})(d)}}else g=i.match(b.dataTypePattern),k=g.slice(1),f=k[0],d=k[1],f=f!=null?parseInt(f):0,f===0||f===1?function(a){return c=function(){return b.dataAccessors[a](m.view)}}(d):function(a,d){return c=function(){var c,e,f;c=new b.typedArray[d](a);for(e=0,f=a-1;0<=f?e<=f:e>=f;0<=f?e++:e--)c[e]=b.dataAccessors[d](m.view);return c}}(f,d);l.push(this.accessors.push(c))}return l},b.prototype.defineGetRow=function(){var a;return a=this.zblank!=null||this.blank!=null||this.columnNames.hasOwnProperty("ZBLANK"),this.getRow=a?this.getRowHasBlanks:this.getRowNoBlanks},b.prototype.setDefaultParameters_RICE_1=function(){this.algorithmParameters.hasOwnProperty("BLOCKSIZE")||(this.algorithmParameters.BLOCKSIZE=32);if(!this.algorithmParameters.hasOwnProperty("BYTEPIX"))return this.algorithmParameters.BYTEPIX=4},b.setValue=function(a,b,c){return a.contains(b)?a[b]:c},b.prototype.getFrame=function(){var a,b,c,d,e;this.rowsRead=0,this.data=new Float32Array(this.ztile[0]*this.rows);for(;;){c=this.getRow();for(a=0,e=c.length;a<e;a++)d=c[a],b=this.rowsRead*this.ztile[0]+a,this.data[this.rowsRead*this.ztile[0]+a]=d;if(this.rowsRead===this.rows)break}return this.data},b.prototype.getRowHasBlanks=function(){var a,b,c,d,e,f,g,h,i;i=this._getRow(),b=i[0],a=i[1],e=i[2],g=i[3],d=new Float32Array(b.length);for(c=0,h=b.length;c<h;c++){f=b[c];if(f===a){d[c]=NaN;continue}d[c]=g+e*f}return d},b.prototype.getRowNoBlanks=function(){var a,b,c,d,e,f,g,h,i;i=this._getRow(),b=i[0],a=i[1],e=i[2],g=i[3],d=new Float32Array(b.length);for(c=0,h=b.length;c<h;c++)f=b[c],d[c]=g+e*f;return d},b.prototype._accessor=function(a){var c,d,e,f,g,h;g=[this.view.getInt32(),this.view.getInt32()],e=g[0],f=g[1];if(e===0)return null;c=new b.typedArray[a](e),this.current=this.view.tell(),this.view.seek(this.begin+this.tableLength+f);for(d=0,h=e-1;0<=h?d<=h:d>=h;0<=h?d++:d--)c[d]=b.dataAccessors[a](this.view);return this.view.seek(this.current),c},b.prototype._getRow=function(){var a,b,c,d,e,f,g,h,i;this.current=this.begin+this.rowsRead*this.rowByteSize,this.view.seek(this.current),d=[],i=this.accessors;for(g=0,h=i.length;g<h;g++)a=i[g],d.push(a());return this.rowsRead+=1,c=d[this.columnNames.COMPRESSED_DATA]||d[this.columnNames.UNCOMPRESSED_DATA]||d[this.columnNames.GZIP_COMPRESSED_DATA],b=d[this.columnNames.ZBLANK]||this.zblank,e=d[this.columnNames.ZSCALE]||this.bscale,f=d[this.columnNames.ZZERO]||this.bzero,[c,b,e,f]},b.prototype.getExtremes=function(){var a,b,c,d,e,f,g,h,i,j;if(this.min!=null&&this.max!=null)return[this.min,this.max];g=this.data;for(b=0,f=g.length;b<f;b++){e=g[b];if(isNaN(e))continue;h=[e,e],d=h[0],c=h[1];break}for(a=b,i=this.data.length-1;b<=i?a<=i:a>=i;b<=i?a++:a--){e=this.data[a];if(isNaN(e))continue;e<d&&(d=e),e>c&&(c=e)}return j=[d,c],this.min=j[0],this.max=j[1],[this.min,this.max]},b.subtractiveDither1=function(){throw"Not yet implemented"},b.linearScaling=function(){throw"Not yet implemented"},b}(e),typeof c!="undefined"&&c!==null&&(c.exports=a)})).call(this)},"fits.data":function(a,b,c){((function(){var a,d,e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};d=b("./fits.module"),a=function(a){function b(a,b){this.view=a,this.begin=this.current=a.tell(),this.length=void 0}return f(b,a),b}(d),typeof c!="undefined"&&c!==null&&(c.exports=a)})).call(this)},"fits.decompress":function(a,b,c){((function(){var a;a={Rice:function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;h=1<<k,u=this.RiceSetup[d](a),k=u[0],l=u[1],p=u[2],t=u[3],r=new Uint8Array(256),s=8,v=[128,255],o=v[0],m=v[1];while(m>=0){while(m>=o)r[m]=s,m-=1;o/=2,s-=1}r[0]=0,g=a[t],t+=1,q=8,m=0;while(m<f){q-=k;while(q<0)g=g<<8|a[t],t+=1,q+=8;j=(g>>q)-1,g&=(1<<q)-1,n=m+c,n>f&&(n=f);if(j<0)while(m<n)a[m]=p,m++;else if(j===l)while(m<n){o=h-q,i=g<<o,o-=8;while(o>=0)g=a[t],t+=1,i|=g<<o,o-=8;q>0?(g=a[t],t+=1,i|=g>>-o,g&=(1<<q)-1):g=0,(i&1)===0?i>>=1:i=~(i>>1),a[m]=i+p,p=a[m],m++}else while(m<n){while(g===0)q+=8,g=a[t],t+=1;s=q-r[g],q-=s+1,g^=1<<q,q-=j;while(q<0)g=g<<8|a[t],t+=1,q+=8;i=s<<j|g>>q,g&=(1<<q)-1,(i&1)===0?i>>=1:i=~(i>>1),e[m]=i+p,p=e[m],m++}}return e},RiceSetup:{1:function(a){var b,c,d,e;return e=0,b=3,c=6,d=a[e],e+=1,[b,c,d,e]},2:function(a){var b,c,d,e,f;return f=0,c=4,d=14,e=0,b=a[f],f+=1,e|=b<<8,b=a[f],f+=1,e|=b,[c,d,e,f]},4:function(a){var b,c,d,e,f;return f=0,c=5,d=25,e=0,b=a[f],f+=1,e|=b<<24,b=a[f],f+=1,e|=b<<16,b=a[f],f+=1,e|=b<<8,b=a[f],f+=1,e|=b,[c,d,e,f]}},gzip:function(a){throw"Not yet implemented"},plio:function(a,b){throw"Not yet implemented"},hcompress:function(a,b){throw"Not yet implemented"}},typeof c!="undefined"&&c!==null&&(c.exports=a)})).call(this)},"fits.file":function(a,b,c){((function(){var a,d,e,f,g,h,i;f=b("./fits.hdu"),g=b("./fits.header"),h=b("./fits.image"),d=b("./fits.compressedimage"),i=b("./fits.table"),a=b("./fits.binarytable"),e=function(){function b(a){var b,c,d;this.length=a.byteLength,this.view=new jDataView(a,void 0,void 0,!1),this.hdus=[],this.eof=!1;for(;;){d=this.readHeader(),b=this.readData(d),c=new f(d,b),this.hdus.push(c);if(this.eof)break}}return b.LINEWIDTH=80,b.BLOCKLENGTH=2880,b.excessBytes=function(a){return(b.BLOCKLENGTH-a%b.BLOCKLENGTH)%b.BLOCKLENGTH},b.prototype.readHeader=function(){var a,c,d,e;e=0,c=new g;for(;;){d=this.view.getString(b.LINEWIDTH),e+=1,c.readCard(d);if(d.slice(0,4)==="END ")break}return a=b.excessBytes(e*b.LINEWIDTH),this.view.seek(this.view.tell()+a),this.checkEOF(),c},b.prototype.readData=function(c){var e,f;if(!c.hasDataUnit())return;return c.isPrimary()?e=new h(this.view,c):c.isExtension()&&(c.extensionType==="BINTABLE"?c.contains("ZIMAGE")?e=new d(this.view,c):e=new a(this.view,c):c.extensionType==="TABLE"&&(e=new i(this.view,c))),f=b.excessBytes(e.length),this.view.seek(this.view.tell()+e.length+f),this.checkEOF(),e},b.prototype.checkEOF=function(){if(this.view.tell()===this.length)return this.eof=!0},b.prototype.count=function(){return this.hdus.length},b.prototype.getHDU=function(a){var b,c,d,e;a==null&&(a=void 0);if(a!=null&&this.hdus[a]!=null)return this.hdus[a];e=this.hdus;for(c=0,d=e.length;c<d;c++){b=e[c];if(b.hasData())return b}},b.prototype.getHeader=function(a){return a==null&&(a=void 0),this.getHDU(a).header},b.prototype.getDataUnit=function(a){return a==null&&(a=void 0),this.getHDU(a).data},b.prototype.getData=function(a){return a==null&&(a=void 0),this.getHDU(a).data.getFrame()},b}(),typeof c!="undefined"&&c!==null&&(c.exports=e)})).call(this)},"fits.hdu":function(a,b,c){((function(){var a;a=function(){function a(a,b){this.header=a,this.data=b}return a.prototype.hasData=function(){return this.data!=null?!0:!1},a.prototype.getCard=function(a){return this.header[a]},a}(),typeof c!="undefined"&&c!==null&&(c.exports=a)})).call(this)},"fits.header":function(a,b,c){((function(){var a,d,e,f=Object.prototype.hasOwnProperty,g=function(a,b){function d(){this.constructor=a}for(var c in b)f.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};d=b("./fits.module"),e=b("./fits.header.verify"),a=function(a){function b(){var a,b,c;this.verifyCard={},c=this.Functions;for(b in c)a=c[b],this.verifyCard[b]=this.proxy(a);this.cards={},this.cardIndex=0}return g(b,a),b.keywordPattern=/([\w_-]+)\s*=?\s*(.*)/,b.nonStringPattern=/([^\/]*)\s*\/*(.*)/,b.stringPattern=/'(.*)'\s*\/*(.*)/,b.arrayPattern=/([A-Za-z]+)(\d+)/,b.include(e),b.prototype.get=function(a){return this.contains(a)?this.cards[a]:console.warn("Header does not contain the key "+a)},b.prototype.getIndex=function(a){return this.contains(a)?this.cards[a][0]:console.warn("Header does not contain the key "+a)},b.prototype.getComment=function(a){return this.contains(a)?this.cards[a][2]!=null?this.cards[a][2]:console.warn(""+a+" does not contain a comment"):console.warn("Header does not contain the key "+a)},b.prototype.getComments=function(){return this.contains("COMMENT")?this.cards.COMMENT:console.warn("Header does not contain any COMMENT fields")},b.prototype.getHistory=function(){return this.contains("HISTORY")?this.cards.HISTORY:console.warn("Header does not contain any HISTORY fields")},b.prototype.set=function(a,b,c){return this.cards[a]=c?[this.cardIndex,b,c]:[this.cardIndex,b],this.cardIndex+=1},b.prototype.setComment=function(a){return this.contains("COMMENT")||(this.cards.COMMENT=[],this.cardIndex+=1),this.cards.COMMENT.push(a)},b.prototype.setHistory=function(a){return this.contains("HISTORY")||(this.cards.HISTORY=[],this.cardIndex+=1),this.cards.HISTORY.push(a)},b.prototype.contains=function(a){return this.cards.hasOwnProperty(a)},b.prototype.readCard=function(a){var c,d,e,f,g,h,i,j,k,l,m,n;h=a.match(b.keywordPattern);if(h==null)return;j=h.slice(1),f=j[0],i=j[1],f==="COMMENT"||f==="HISTORY"?h[1]=i.trim():i[0]==="'"?(h=i.match(b.stringPattern),h[1]=h[1].trim()):(h=i.match(b.nonStringPattern),h[1]=(k=h[1][0])==="T"||k==="F"?h[1].trim():parseFloat(h[1])),h[2]=h[2].trim(),l=h.slice(1),i=l[0],d=l[1],g=f,m=[!1,void 0],c=m[0],e=m[1],h=f.match(b.arrayPattern),h!=null&&(g=h[1],n=[!0,h[2]],c=n[0],e=n[1]),this.verifyCard.hasOwnProperty(g)&&(i=this.verifyCard[g](i,c,e));switch(f){case"COMMENT":return this.setComment(i);case"HISTORY":return this.setHistory(i);default:return this.set(f,i,d),this.__defineGetter__(f,function(){return this.cards[f][1]})}},b.prototype.hasDataUnit=function(){return this.NAXIS===0?!1:!0},b}(d),typeof c!="undefined"&&c!==null&&(c.exports=a)})).call(this)},"fits.header.verify":function(a,b,c){((function(){var a,b=Array.prototype.slice;a={primary:!1,extension:!1,isPrimary:function(){return this.primary},isExtension:function(){return this.extension},verifyOrder:function(a,b){if(b!==this.cardIndex)return console.warn(""+a+" should appear at index "+b+" in the FITS header")},verifyBetween:function(a,b,c,d){if(!(b>=c&&b<=d))throw"The "+a+" value of "+b+" is not between "+c+" and "+d},verifyInteger:function(a,b){var c;c=parseInt(b);if(c!==b)throw"The "+a+" value of "+b+" is not an integer";return c},Functions:{SIMPLE:function(){var a,c;return a=1<=arguments.length?b.call(arguments,0):[],c=arguments[0],this.primary=!0,this.verifyOrder("SIMPLE",0),c==="T"?!0:!1},XTENSION:function(){var a,c;return a=1<=arguments.length?b.call(arguments,0):[],c=arguments[0],this.extension=!0,this.extensionType=c,this.verifyOrder("XTENSION",0),c},BITPIX:function(){var a,c,d;a=1<=arguments.length?b.call(arguments,0):[],c="BITPIX",d=this.verifyInteger(c,arguments[0]),this.verifyOrder(c,1);if(d!==8&&d!==16&&d!==32&&d!==64&&d!==-32&&d!==-64)throw""+c+" value "+d+" is not permitted";return parseInt(d)},NAXIS:function(){var a,c,d,e,f,g;a=1<=arguments.length?b.call(arguments,0):[],d="NAXIS",f=arguments[0],c=arguments[1],f=this.verifyInteger(d,f);if(!c){this.verifyOrder(d,2),this.verifyBetween(d,f,0,999);if(this.isExtension())if((g=this.extensionType)==="TABLE"||g==="BINTABLE"){e=2;if(f!==e)throw""+d+" must be "+e+" for TABLE and BINTABLE extensions"}}return f},PCOUNT:function(){var a,c,d,e,f,g;a=1<=arguments.length?b.call(arguments,0):[],c="PCOUNT",f=this.verifyInteger(c,arguments[0]),d=3+this.NAXIS,this.verifyOrder(c,d);if(this.isExtension())if((g=this.extensionType)==="IMAGE"||g==="TABLE"){e=0;if(f!==e)throw""+c+" must be "+e+" for the "+this.extensionType+" extensions"}return f},GCOUNT:function(){var a,c,d,e,f,g;a=1<=arguments.length?b.call(arguments,0):[],c="GCOUNT",f=this.verifyInteger(c,arguments[0]),d=3+this.NAXIS+1,this.verifyOrder(c,d);if(this.isExtension())if((g=this.extensionType)==="IMAGE"||g==="TABLE"||g==="BINTABLE"){e=1;if(f!==e)throw""+c+" must be "+e+" for the "+this.extensionType+" extensions"}return f},EXTEND:function(){var a,c,d;a=1<=arguments.length?b.call(arguments,0):[],c="EXTEND",d=arguments[0];if(!this.isPrimary())throw""+c+" must only appear in the primary header";return d==="T"?!0:!1},BSCALE:function(){var a;return a=1<=arguments.length?b.call(arguments,0):[],parseFloat(arguments[0])},BZERO:function(){var a;return a=1<=arguments.length?b.call(arguments,0):[],parseFloat(arguments[0])},BLANK:function(){var a,c,d;a=1<=arguments.length?b.call(arguments,0):[],c="BLANK",d=arguments[0];if(this.BIXPIX>0)return this.verifyInteger(d);throw""+c+" is not to be used for BITPIX = "+this.BITPIX},DATAMIN:function(){var a;return a=1<=arguments.length?b.call(arguments,0):[],parseFloat(arguments[0])},DATAMAX:function(){var a;return a=1<=arguments.length?b.call(arguments,0):[],parseFloat(arguments[0])},EXTVER:function(){var a,c;return a=1<=arguments.length?b.call(arguments,0):[],key("EXTVER"),c=arguments[0],c=this.verifyInteger(key,c),c},EXTLEVEL:function(){var a,c,d;return a=1<=arguments.length?b.call(arguments,0):[],c="EXTLEVEL",d=arguments[0],d=this.verifyInteger(c,d),d},TFIELDS:function(){var a,c,d;return a=1<=arguments.length?b.call(arguments,0):[],c="TFIELDS",d=arguments[0],d=this.verifyInteger(c,d),this.verifyBetween(c,d,0,999),d},TBCOL:function(){var a,c,d,e;return a=1<=arguments.length?b.call(arguments,0):[],d="TBCOL",e=arguments[0],c=arguments[2],this.verifyBetween(d,c,0,this.TFIELDS),e},ZIMAGE:function(){var a,c,d;return a=1<=arguments.length?b.call(arguments,0):[],c="ZIMAGE",d=arguments[0],d==="T"?!0:!1},ZCMPTYPE:function(){var a,c,d;a=1<=arguments.length?b.call(arguments,0):[],c="ZCMPTYPE",d=arguments[0];if(d!=="GZIP_1"&&d!=="RICE_1"&&d!=="PLIO_1"&&d!=="HCOMPRESS_1")throw""+c+" value "+d+" is not permitted";if(d!=="RICE_1")throw"Compress type "+d+" is not yet implement";return d},ZBITPIX:function(){var a,c,d;a=1<=arguments.length?b.call(arguments,0):[],c="ZBITPIX",d=this.verifyInteger(c,arguments[0]);if(d!==8&&d!==16&&d!==32&&d!==64&&d!==-32&&d!==-64)throw""+c+" value "+d+" is not permitted";return parseInt(d)},ZNAXIS:function(){var a,c,d,e;return a=1<=arguments.length?b.call(arguments,0):[],d="ZNAXIS",e=arguments[0],c=arguments[1],e=this.verifyInteger(d,e),c||this.verifyBetween(d,e,0,999),e},ZTILE:function(){var a,c,d;return a=1<=arguments.length?b.call(arguments,0):[],c="ZTILE",d=this.verifyInteger(c,arguments[0]),d},ZSIMPLE:function(){var a;return a=1<=arguments.length?b.call(arguments,0):[],arguments[0]==="T"?!0:!1},ZPCOUNT:function(){var a,c,d;return a=1<=arguments.length?b.call(arguments,0):[],c="ZPCOUNT",d=arguments[0],this.verifyInteger(c,d)},ZGCOUNT:function(){var a,c,d;return a=1<=arguments.length?b.call(arguments,0):[],c="ZGCOUNT",d=arguments[0],this.verifyInteger(c,d)}}},typeof c!="undefined"&&c!==null&&(c.exports=a)})).call(this)},"fits.image":function(a,b,c){((function(){var a,d,e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};a=b("./fits.data"),d=function(a){function b(a,c){var d,e,f,g=this;b.__super__.constructor.apply(this,arguments),f=c.NAXIS,d=c.BITPIX,this.naxis=[];for(e=1;1<=f?e<=f:e>=f;1<=f?e++:e--)this.naxis.push(c["NAXIS"+e]);this.rowByteSize=c.NAXIS1*Math.abs(d)/8,this.rowsRead=0,this.min=c["DATAMIN"]!=null?c.DATAMIN:void 0,this.max=c["DATAMAX"]!=null?c.DATAMAX:void 0,this.length=this.naxis.reduce(function(a,b){return a*b})*Math.abs(d)/8,this.data=void 0,this.frame=-1;switch(d){case 8:this.arrayType=Uint8Array,this.accessor=function(){return g.view.getUint8()};break;case 16:this.arrayType=Int16Array,this.accessor=function(){return g.view.getInt16()};break;case 32:this.arrayType=Int32Array,this.accessor=function(){return g.view.getInt32()};break;case 64:this.arrayType=Int32Array,this.accessor=function(){var a,b,c,d,e;return console.warn("Something funky happens here when dealing with 64 bit integers.  Be wary!!!"),b=Math.abs(g.view.getInt32()),c=Math.abs(g.view.getInt32()),d=b%10,a=d?-1:1,b-=d,e=a*(b<<32|c),e};break;case-32:this.arrayType=Float32Array,this.accessor=function(){return g.view.getFloat32()};break;case-64:this.arrayType=Float64Array,this.accessor=function(){return g.view.getFloat64()};break;default:throw"FITS keyword BITPIX does not conform to one of the following set values [8, 16, 32, 64, -32, -64]"}}return f(b,a),b.prototype.initArray=function(){return this.data=new this.arrayType(this.naxis.reduce(function(a,b){return a*b}))},b.prototype.getRow=function(){var a,b,c;this.current=this.begin+this.rowsRead*this.rowByteSize,b=this.naxis[0],this.view.seek(this.current);for(a=0,c=b-1;0<=c?a<=c:a>=c;0<=c?a++:a--)this.data[b*this.rowsRead+a]=this.accessor();return this.rowsRead+=1},b.prototype.getFrame=function(){var a,b;this.data==null&&this.initArray();for(a=0,b=this.naxis[1]-1;0<=b?a<=b:a>=b;0<=b?a++:a--)this.getRow();return this.frame+=1,this.data},b.prototype.getFrameWebGL=function(){var a,b,c,d,e;this.data=new Float32Array(this.naxis.reduce(function(a,b){return a*b})),this.rowsRead=0,c=this.naxis[0];for(b=0,d=this.naxis[1]-1;0<=d?b<=d:b>=d;0<=d?b++:b--){this.current=this.begin+this.rowsRead*this.rowByteSize,this.view.seek(this.current);for(a=0,e=c-1;0<=e?a<=e:a>=e;0<=e?a++:a--)this.data[c*this.rowsRead+a]=this.accessor();this.rowsRead+=1}return this.frame+=1,this.data},b.prototype.getExtremes=function(){var a,b,c,d,e,f,g,h,i,j;if(this.min!=null&&this.max!=null)return[this.min,this.max];g=this.data;for(b=0,f=g.length;b<f;b++){e=g[b];if(isNaN(e))continue;h=[e,e],d=h[0],c=h[1];break}for(a=b,i=this.data.length-1;b<=i?a<=i:a>=i;b<=i?a++:a--){e=this.data[a];if(isNaN(e))continue;e<d&&(d=e),e>c&&(c=e)}return j=[d,c],this.min=j[0],this.max=j[1],[this.min,this.max]},b.prototype.getPixel=function(a,b){return this.data[this.frame*this.naxis[0]*this.naxis[1]+b*this.naxis[0]+a]},b.prototype.seek=function(a){return a==null&&(a=0),this.naxis.length===2?(this.rowsRead=0,this.frame=-1):(this.rowsRead=this.naxis[1]*(a+1),this.frame=this.naxis[1]/this.rowsRead-1)},b}(a),typeof c!="undefined"&&c!==null&&(c.exports=d)})).call(this)},"fits.imageset":function(a,b,c){((function(){var a;a=function(){function a(){this.images={},this.keys=[],this.minimum=void 0,this.maximum=void 0,this.count=0}return a.prototype.getExtremes=function(){var a,b,c,d,e,f,g;f=[],e=[],g=this.images;for(d in g)c=g[d],a=c.getHDU().data,a.getFrame(),b=a.getExtremes(),f.push(b[0]),e.push(b[1]);return this.minimum=Math.min.apply(Math,f),this.maximum=Math.max.apply(Math,e)},a.prototype.addImage=function(a){var b,c;return b=a.getHDU().header.FILTER||this.count,this.keys.push(b),this.images[b]=a,c=this.count,this.__defineGetter__(c,function(){return this.images[this.keys[c]]}),this.count+=1},a.prototype.getWidth=function(){var a;return a=this.keys[0],this.images[a]==null?null:this.images[a].getHDU().header.NAXIS1},a.prototype.getHeight=function(){var a;return a=this.keys[0],this.images[a]==null?null:this.images[a].getHDU().header.NAXIS2},a.prototype.getCount=function(){return this.count},a.prototype.getData=function(a){return this[a].getHDU().data.data},a.prototype.seek=function(a){var b,c,d,e;a==null&&(a=0),d=this.images,e=[];for(c in d)b=d[c],e.push(b.getDataUnit().seek(a));return e},a}(),typeof c!="undefined"&&c!==null&&(c.exports=a)})).call(this)},"fits.imagestats":function(a,b,c){((function(){var a,d,e,f;b("jDataView/src/jdataview"),d=b("./fits.header"),e=b("./fits.image"),a=b("./fits.compressedimage"),f=function(){function a(a){var b;this.image=a,b=this.image.getExtremes(),this.minimum=b[0],this.maximum=b[1],this.pixels=this.image.naxis.reduce(function(a,b){return a*b}),this.mean=void 0,this.std=void 0,this.histogram=void 0,this.bins=void 0}return a.prototype.computeMean=function(){var a,b,c,d,e;if(this.mean!=null)return this.mean;b=0,e=this.image.data;for(c=0,d=e.length;c<d;c++)a=e[c],b+=a;return this.mean=b/this.pixels},a.prototype.computeSTD=function(){var a,b,c,d,e,f;if(this.std!=null)return this.std;this.mean==null&&this.computeMean(),c=0,f=this.image.data;for(d=0,e=f.length;d<e;d++)b=f[d],a=b-this.mean,c+=a*a;return this.std=Math.sqrt(c/this.pixels)},a.prototype.computeHistogram=function(a){var b,c,d,e,f,g,h,i;this.bins=a!=null?a:100,g=this.maximum-this.minimum,c=g/this.bins,d=this.image.data,this.pixels<256?b=Uint8Array:this.pixels<65535?b=Uint16Array:b=Uint32Array,this.histogram=new b(this.bins+1);for(h=0,i=d.length;h<i;h++)f=d[h],e=Math.floor((f-this.minimum)/g*this.bins),this.histogram[e]+=1;return this.histogram},a}(),typeof c!="undefined"&&c!==null&&(c.exports=f)})).call(this)},"fits.module":function(a,b,c){((function(){var a,b,d=Array.prototype.indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};b=["included","extended"],a=function(){function a(){}return a.include=function(a){var c,e,f;if(!a)throw"include(obj) requires obj";for(c in a)e=a[c],d.call(b,c)<0&&(this.prototype[c]=e);return(f=a.included)!=null&&f.apply(this),this},a.extend=function(a){var c,e,f;if(!a)throw"extend(obj) requires obj";for(c in a)e=a[c],d.call(b,c)<0&&(this[c]=e);return(f=a.extended)!=null&&f.apply(this),this},a.proxy=function(a){var b=this;return function(){return a.apply(b,arguments)}},a.prototype.proxy=function(a){var b=this;return function(){return a.apply(b,arguments)}},a}(),typeof c!="undefined"&&c!==null&&(c.exports=a)})).call(this)},"fits.table":function(a,b,c){((function(){var a,d,e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};d=b("./fits.tabular"),a=function(a){function b(a,c){var d,e,f,g,h,i=this;b.__super__.constructor.apply(this,arguments),g=function(){var a,b,c,d,e;return e=f.slice(1),b=e[0],d=e[1],c=e[2],a=function(){var a,c;c="";for(a=1;1<=d?a<=d:a>=d;1<=d?a++:a--)c+=i.view.getChar();return FITS.Table.dataAccessors[b](c)},i.accessors.push(a)};for(e=1,h=this.cols;1<=h?e<=h:e>=h;1<=h?e++:e--)d=c["TFORM"+e],f=d.match(b.formPattern),g()}return f(b,a),b.formPattern=/([AIFED])(\d+)\.(\d+)/,b.dataAccessors={A:function(a){return a},I:function(a){return parseInt(a)},F:function(a){return parseFloat(a)},E:function(a){return parseFloat(a)},D:function(a){return parseFloat(a)}},b}(d),typeof c!="undefined"&&c!==null&&(c.exports=a)})).call(this)},"fits.tabular":function(a,b,c){((function(){var a,d,e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};a=b("./fits.data"),d=function(a){function b(a,c){b.__super__.constructor.apply(this,arguments),this.rowByteSize=c.NAXIS1,this.rows=c.NAXIS2,this.cols=c.TFIELDS,this.length=this.tableLength=this.rowByteSize*this.rows,this.rowsRead=0,this.accessors=[]}return f(b,a),b.dataAccessors={L:function(a){var b;return b=a.getInt8()===84?!0:!1,b},X:function(a){throw"Data type not yet implemented"},B:function(a){return a.getUint8()},I:function(a){return a.getInt16()},J:function(a){return a.getInt32()},K:function(a){var b,c,d,e,f;return c=Math.abs(a.getInt32()),d=Math.abs(a.getInt32()),e=c%10,b=e?-1:1,c-=e,f=b*(c<<32|d),console.warn("Something funky happens here when dealing with 64 bit integers.  Be wary!!!"),f},A:function(a){return a.getChar()},E:function(a){return a.getFloat32()},D:function(a){return a.getFloat64()},C:function(a){return[a.getFloat32(),a.getFloat32()]},M:function(a){return[a.getFloat64(),a.getFloat64()]}},b.prototype.getRow=function(){var a,b,c,d,e;this.current=this.begin+this.rowsRead*this.rowByteSize,this.view.seek(this.current),b=[],e=this.accessors;for(c=0,d=e.length;c<d;c++)a=e[c],b.push(a());return this.rowsRead+=1,b},b}(a),typeof c!="undefined"&&c!==null&&(c.exports=d)})).call(this)},"fits.visualize":function(a,b,c){((function(){var a;a=function(){function a(b,c){var d,e,f,g,h;this.imgset=b,this.el=c,this.imgset.getExtremes(),this.width=this.imgset.getWidth(),this.height=this.imgset.getHeight(),this.minimum=this.imgset.minimum,this.maximum=this.imgset.maximum,this.setupUI(this.width,this.height),this.gl=this.setupWebGL();if(!this.gl)return alert("No WebGL"),null;this.ext=this.gl.getExtension("OES_texture_float");if(!this.ext)return alert("No OES_texture_float"),null;h=this.loadShader(a.vertexShader,this.gl.VERTEX_SHADER),this.fragmentShader=this.loadShader(a.fragmentShaders.linear,this.gl.FRAGMENT_SHADER),this.createProgram([h,this.fragmentShader]),this.gl.useProgram(this.program),e=this.gl.getAttribLocation(this.program,"a_position"),f=this.gl.getUniformLocation(this.program,"u_resolution"),this.stretchLocation=this.gl.getUniformLocation(this.program,"u_stretch"),this.gl.uniform2f(f,this.width,this.height),this.extremesLocation=this.gl.getUniformLocation(this.program,"u_extremes"),this.gl.uniform2f(this.extremesLocation,this.minimum,this.maximum),d=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,d),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),this.gl.STATIC_DRAW),this.gl.enableVertexAttribArray(e),this.gl.vertexAttribPointer(e,2,this.gl.FLOAT,!1,0,0),g=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,g),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,this.width,this.height,0,this.gl.LUMINANCE,this.gl.FLOAT,this.imgset[3].getHDU().data.getFrameWebGL()),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.drawArrays(this.gl.TRIANGLES,0,6),console.log(this.gl.getError())}return a.GET_A_WEBGL_BROWSER='This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to upgrade your browser.</a>',a.OTHER_PROBLEM='It doesn\'t appear your computer can support WebGL.<br/><a href="http://get.webgl.org/troubleshooting/">Click here for more information.</a>',a.vertexShader=["attribute vec2 a_position;","void main() {","gl_Position = vec4(a_position, 0, 1);","}"].join("\n"),a.fragmentShaders={linear:["precision mediump float;","uniform vec2 u_resolution;","uniform sampler2D u_tex;","uniform vec2 u_extremes;","void main() {","vec2 texCoord = gl_FragCoord.xy / u_resolution;","vec4 pixel_v = texture2D(u_tex, texCoord);","float min = u_extremes[0];","float max = u_extremes[1];","float pixel = (pixel_v[0] - min) / (max - min);","gl_FragColor = vec4(pixel, pixel, pixel, 1.0);","}"].join("\n"),logarithm:["precision mediump float;","uniform vec2 u_resolution;","uniform sampler2D u_tex;","uniform vec2 u_extremes;","void main() {","vec2 texCoord = gl_FragCoord.xy / u_resolution;","vec4 pixel_v = texture2D(u_tex, texCoord);","float min = log(u_extremes[0]);","float max = log(u_extremes[1]);","float pixel = (log(pixel_v[0]) - min) / (max - min);","gl_FragColor = vec4(pixel, pixel, pixel, 1.0);","}"].join("\n"),sqrt:["precision mediump float;","uniform vec2 u_resolution;","uniform sampler2D u_tex;","uniform vec2 u_extremes;","void main() {","vec2 texCoord = gl_FragCoord.xy / u_resolution;","vec4 pixel_v = texture2D(u_tex, texCoord);","float min = sqrt(u_extremes[0]);","float max = sqrt(u_extremes[1]);","float pixel = (sqrt(pixel_v[0]) - min) / (max - min);","gl_FragColor = vec4(pixel, pixel, pixel, 1.0);","}"].join("\n"),arcsinh:["precision mediump float;","uniform vec2 u_resolution;","uniform sampler2D u_tex;","uniform vec2 u_extremes;","float arcsinh(float value) {","return log(value + sqrt(1.0 + value * value));","}","void main() {","vec2 texCoord = gl_FragCoord.xy / u_resolution;","vec4 pixel_v = texture2D(u_tex, texCoord);","float min = arcsinh(u_extremes[0]);","float max = arcsinh(u_extremes[1]);","float value = arcsinh(pixel_v[0]);","float pixel = (value - min) / (max - min);","gl_FragColor = vec4(pixel, pixel, pixel, 1.0);","}"].join("\n"),power:["precision mediump float;","uniform vec2 u_resolution;","uniform sampler2D u_tex;","uniform vec2 u_extremes;","void main() {","vec2 texCoord = gl_FragCoord.xy / u_resolution;","vec4 pixel_v = texture2D(u_tex, texCoord);","float min = pow(u_extremes[0], 2.0);","float max = pow(u_extremes[1], 2.0);","float pixel = (pow(pixel_v[0], 2.0) - min) / (max - min);","gl_FragColor = vec4(pixel, pixel, pixel, 1.0);","}"].join("\n"),color:["precision mediump float;","uniform vec2 u_resolution;","uniform sampler2D u_tex_g;","uniform sampler2D u_tex_r;","uniform sampler2D u_tex_i;","uniform vec2 u_extremes;","float arcsinh(float value) {","return log(value + sqrt(1.0 + value * value));","}","float f(float minimum, float maximum, float value) {","float pixel = clamp(value, minimum, maximum);","float alpha = 0.02;","float Q = 8.0;","return arcsinh(alpha * Q * (pixel - minimum)) / Q;","}","void main() {","vec2 texCoord = gl_FragCoord.xy / u_resolution;","vec4 pixel_v_g = texture2D(u_tex_g, texCoord);","vec4 pixel_v_r = texture2D(u_tex_r, texCoord);","vec4 pixel_v_i = texture2D(u_tex_i, texCoord);","float minimum = u_extremes[0];","float maximum = u_extremes[1];","float g = pixel_v_g[0];","float r = pixel_v_r[0];","float i = pixel_v_i[0];","float I = (g + r + i) / 3.0;","float fI = f(minimum, maximum, I);","float fII = fI / I;","float R = i * fII;","float G = r * fII;","float B = g * fII;","float RGBmax = max(max(R, G), B);","if (RGBmax > 1.0) {","R = R / RGBmax;","G = G / RGBmax;","B = B / RGBmax;","}","if (I == 0.0) {","R = 0.0;","G = 0.0;","B = 0.0;","}","gl_FragColor = vec4(R, G, B, 1.0);","}"].join("\n")},a.prototype.setupWebGL=function(b){var c,d;return d=function(a){var b;b=this.canvas.parentNode;if(b)return b.innerHTML=this.makeFailHTML(a)},window.WebGLRenderingContext?(c=this.create3DContext(this.canvas,b),c||d(a.OTHER_PROBLEM),c):(d(a.GET_A_WEBGL_BROWSER),null)},a.prototype.create3DContext=function(a){var b,c,d,e,f;e=["webgl","experimental-webgl"],b=null;for(c=0,f=e.length;c<f;c++){d=e[c];try{b=this.canvas.getContext(d,a)}catch(g){}if(b)break}return b},a.prototype.makeFailHTML=function(a){return'<table style="background-color: #8CE; width: 100%; height: 100%;"><tr><td align="center"><div style="display: table-cell; vertical-align: middle;"><div style="">'+a+"</div>"+"</div>"+"</td></tr></table>"},a.prototype.createProgram=function(a,b,c){var d,e,f,g,h,i,j;this.program=this.gl.createProgram();for(e=0,i=a.length;e<i;e++)h=a[e],this.gl.attachShader(this.program,h);if(b!=null)for(e=0,j=b.length;e<j;e++)d=b[e],g=c!=null?c[e]:e,this.gl.bindAttribLocation(this.program,g,d);this.gl.linkProgram(this.program),f=this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS);if(!f)throw"Error in program linking: "+this.gl.getProgramInfoLog(this.program)},a.prototype.loadShader=function(a,b){var c,d,e;e=this.gl.createShader(b),this.gl.shaderSource(e,a),this.gl.compileShader(e),c=this.gl.getShaderParameter(e,this.gl.COMPILE_STATUS);if(!c)throw d=this.gl.getShaderInfoLog(e),"Error compiling shader "+e+": "+d;return e},a.prototype.setupUI=function(a,b){var c,d;c=document.getElementById(this.el.getAttribute("id"));while(c.children.length>0)c.removeChild(c.children[0]);return d=document.createElement("div"),d.setAttribute("class","fits-viewer"),this.canvas=document.createElement("canvas"),this.canvas.setAttribute("width",a),this.canvas.setAttribute("height",b),this.el.appendChild(d),d.appendChild(this.canvas)},a.prototype.scale=function(a,b){return this.gl.uniform2f(this.extremesLocation,a,b),this.gl.drawArrays(this.gl.TRIANGLES,0,6)},a.prototype.stretch=function(b){return this.gl.detachShader(this.program,this.fragmentShader),this.gl.deleteShader(this.fragmentShader),this.fragmentShader=this.loadShader(a.fragmentShaders[b],this.gl.FRAGMENT_SHADER),this.gl.attachShader(this.program,this.fragmentShader),this.gl.drawArrays(this.gl.TRIANGLES,0,6)},a}(),typeof c!="undefined"&&c!==null&&(c.exports=a)})).call(this)}})